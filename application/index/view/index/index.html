{include file="common/header" /}
<body id="blog">
{include file="common/nav" /}
<!-- banner start -->
<div class="am-g am-g-fixed blog-fixed am-u-sm-centered blog-article-margin">
    <div data-am-widget="slider" class="am-slider am-slider-b1" data-am-slider='{&quot;controlNav&quot;:false}' >
    <ul class="am-slides">
    {foreach name="$banner" item="b"}
      <li>
            <img src="__IMAGE__{$b['img_url']}" art="{$b['img_des']}">
            <div class="blog-slider-desc am-slider-desc ">
                <div class="blog-text-center blog-slider-con">
                    <span><a href="" class="blog-color">{$b['art']['author']} &nbsp;</a></span>               
                    <h1 class="blog-h-margin"><a href="{:url('Article/detail')}/art_id/{$b['art']['art_id']}">{$b['art']['art_title']}</a></h1>
                    <p>{$b['img_des']}</p>
                    <span class="blog-bor">{:date('Y/m/d',$b['art']['create_time'])}</span>
                    <br><br><br><br><br><br><br>                
                </div>
            </div>
      </li>
      {/foreach}
    </ul>
    </div>
</div>
<!-- banner end -->

<!-- content srart -->
<div class="am-g am-g-fixed blog-fixed" id="html-content">
    <div class="am-u-md-8 am-u-sm-12">
        <div id="flushPage">
        <?php foreach($article as $k => $v): ?>
            <article class="am-g blog-entry-article">
                <div class="am-u-lg-6 am-u-md-12 am-u-sm-12 blog-entry-img">
                    <img src="__IMAGE__{$v['art_img']}" alt="" class="am-u-sm-12">
                </div>
                <div class="am-u-lg-6 am-u-md-12 am-u-sm-12 blog-entry-text">
                    <span><a href="" class="blog-color">{$v['author']} &nbsp;</a></span>
                    <?php if($v['sex'] == 0): ?>
                        <span> @妹子 &nbsp;</span>
                    <?php endif; ?>
                    <?php if($v['sex'] == 1): ?>
                        <span> @渣男 &nbsp;</span>
                    <?php endif; ?>
                    <?php if($v['sex'] == 2): ?>
                        <span> @禽兽 &nbsp;</span>
                    <?php endif; ?>
                    <span>{:date('Y/m/d', $v['create_time'])}</span>
                    <h1><a href="{:url('Article/detail')}/art_id/{$v['art_id']}">{$v['art_title']}</a></h1>
                    <p>{$v['subtitle']}
                    </p>
                    <p><a href="{:url('Article/detail')}/art_id/{$v['art_id']}" class="blog-continue">{$v['art_title']}</a></p>
                </div>
            </article>
        <?php endforeach; ?>
        </div>
        <?php if( count($article) >= 5 ): ?>
            <ul class="am-pagination">
                <li class="am-pagination-prev" style="display: none;"><a class="getPage page-prev" data-page="0" href="javascript:;">&laquo; Prev</a></li>
                <li class="am-pagination-next"><a class="getPage page-next" data-page="1" href="javascript:;">Next &raquo;</a></li>
            </ul>
        <?php endif; ?>
    </div>
    <input type="hidden" name="cate_id" value="{$cate_id}">
<!-- right_content start -->
{include file="common/right_content" /}
<!-- riht_content end -->
    
</div>
{include file="common/footer" /}

<!-- 获取分页数据 -->
<script>
    layui.use(['layer'], function(){
        layer = layui.layer;
    });
    </script>
<script type="text/javascript">
    $(function(){
        $('.getPage').click(function(){
            // 加载图标显示
            var index = layer.load(2, {
                shade: [0.1,'#fff'] //0.1透明度的白色背景,
            });
            var page  = $(this).data('page');
            var cate_id = $("input[name='cate_id']").val();
            var keyboard = $("input[name='keyboard']").val();
            $.post(
                "{:url('Index/getPageData')}",
                {page: page, cate_id:cate_id, keyboard:keyboard},
                function(data){
                    $('.am-pagination-prev').hide();
                    $('.am-pagination-next').hide();
                    // 锚点定位
                    $("html,body").animate({
                        scrollTop:$("#html-content").offset().top
                    },1000);
                    // 关闭加载
                    layer.close(index);
                    if (data['status'] == 1)
                    { 
                        var html = '';
                        for (var i = 0; i < data['res'].length; i++) {
                            html += '<article class="am-g blog-entry-article">';
                                html += '<div class="am-u-lg-6 am-u-md-12 am-u-sm-12 blog-entry-img">';
                                    html += '<img src="__IMAGE__'+data['res'][i]['art_img']+'" alt="" class="am-u-sm-12">';
                                html += '</div>';
                                html += '<div class="am-u-lg-6 am-u-md-12 am-u-sm-12 blog-entry-text">';
                                    html += '<span><a href="" class="blog-color">'+data['res'][i]['author']+' &nbsp;</a></span>';
                                    if (data['res'][i]['sex'] == 0)
                                        html += '<span> @妹子 &nbsp;</span>';
                                    if (data['res'][i]['sex'] == 1)
                                        html += '<span> @渣男 &nbsp;</span>';
                                    if (data['res'][i]['sex'] == 2)
                                        html += '<span> @禽兽 &nbsp;</span>';
                                    html += '<span>'+data['res'][i]['create_time']+'</span>';
                                    html += '<h1><a href="{:url('Article/detail')}/art_id/'+data['res'][i]['art_id']+'">'+data['res'][i]['art_title']+'</a></h1>';
                                    html += '<p>'+data['res'][i]['subtitle']+'</p>';
                                    html += '<p><a href="{:url('Article/detail')}/art_id/'+data['res'][i]['art_id']+'" class="blog-continue">'+data['res'][i]['art_title']+'</a></p></div></article>';
                        }
                        $('#flushPage').html(html);
                        if (page > 0) {
                            $('.am-pagination-prev').show();
                            $('.page-prev').attr("data-page", page-1);
                        }
                        if (data['res'].length == 5) {
                            $('.am-pagination-next').show();
                            $('.page-next').attr("data-page", page+1);
                        } else {
                            $('.am-pagination-next').hide();
                        }
                    } else {
                        var html = '<h3 style="text-align: center; color: #666;">数据已加载完了</h3>';
                        $('#flushPage').html(html);
                        $('.am-pagination-prev').show();
                        $('.page-prev').attr("data-page", page-1);
                    }
                });
        });
    });
</script>